var qcodo={initialize:function(){this.isBrowser=function(intBrowserType){return(intBrowserType&qcodo._intBrowserType)};this.IE=1;this.IE_6_0=2;this.IE_7_0=4;this.FIREFOX=8;this.FIREFOX_1_0=16;this.FIREFOX_1_5=32;this.FIREFOX_2_0=64;this.SAFARI=128;this.SAFARI_2_0=256;this.SAFARI_3_0=512;this.MACINTOSH=1024;this.UNSUPPORTED=2048;if(navigator.userAgent.toLowerCase().indexOf("msie")>=0){this._intBrowserType=this.IE;if(navigator.userAgent.toLowerCase().indexOf("msie 6.0")>=0){this._intBrowserType=this._intBrowserType|this.IE_6_0}else{if(navigator.userAgent.toLowerCase().indexOf("msie 7.0")>=0){this._intBrowserType=this._intBrowserType|this.IE_7_0}else{this._intBrowserType=this._intBrowserType|this.UNSUPPORTED}}}else{if((navigator.userAgent.toLowerCase().indexOf("firefox")>=0)||(navigator.userAgent.toLowerCase().indexOf("iceweasel")>=0)){this._intBrowserType=this.FIREFOX;var strUserAgent=navigator.userAgent.toLowerCase();strUserAgent=strUserAgent.replace("iceweasel/","firefox/");if(strUserAgent.indexOf("firefox/1.0")>=0){this._intBrowserType=this._intBrowserType|this.FIREFOX_1_0}else{if(strUserAgent.indexOf("firefox/1.5")>=0){this._intBrowserType=this._intBrowserType|this.FIREFOX_1_5}else{if(strUserAgent.indexOf("firefox/2.0")>=0){this._intBrowserType=this._intBrowserType|this.FIREFOX_2_0}else{this._intBrowserType=this._intBrowserType|this.UNSUPPORTED}}}}else{if(navigator.userAgent.toLowerCase().indexOf("safari")>=0){this._intBrowserType=this.SAFARI;if(navigator.userAgent.toLowerCase().indexOf("safari/41")>=0){this._intBrowserType=this._intBrowserType|this.SAFARI_2_0}else{if(navigator.userAgent.toLowerCase().indexOf("safari/52")>=0){this._intBrowserType=this._intBrowserType|this.SAFARI_3_0}else{this._intBrowserType=this._intBrowserType|this.UNSUPPORTED}}}else{this._intBrowserType=this.UNSUPPORTED}}}if(navigator.userAgent.toLowerCase().indexOf("macintosh")>=0){this._intBrowserType=this._intBrowserType|this.MACINTOSH}this.loadJavaScriptFile=function(strScript,objCallback){strScript=qc.jsAssets+"/"+strScript;var objNewScriptInclude=document.createElement("script");objNewScriptInclude.setAttribute("type","text/javascript");objNewScriptInclude.setAttribute("src",strScript);document.getElementById(document.getElementById("Qform__FormId").value).appendChild(objNewScriptInclude);if(qc.isBrowser(qcodo.IE)){objNewScriptInclude.callOnLoad=objCallback;objNewScriptInclude.onreadystatechange=function(){if((this.readyState=="complete")||(this.readyState=="loaded")){if(this.callOnLoad){this.callOnLoad()}}}}else{objNewScriptInclude.onload=objCallback}};this.loadStyleSheetFile=function(strStyleSheetFile,strMediaType){strStyleSheetFile=qc.cssAssets+"/"+strStyleSheetFile;if(qc.isBrowser(qcodo.IE)){var objNewScriptInclude=document.createStyleSheet(strStyleSheetFile)}else{var objNewScriptInclude=document.createElement("style");objNewScriptInclude.setAttribute("type","text/css");objNewScriptInclude.setAttribute("media",strMediaType);objNewScriptInclude.innerHTML='@import "'+strStyleSheetFile+'";';document.body.appendChild(objNewScriptInclude)}};this.registerForm=function(){var strFormId=document.getElementById("Qform__FormId").value;this.registerFormHiddenElement("Qform__FormControl",strFormId);this.registerFormHiddenElement("Qform__FormEvent",strFormId);this.registerFormHiddenElement("Qform__FormParameter",strFormId);this.registerFormHiddenElement("Qform__FormCallType",strFormId);this.registerFormHiddenElement("Qform__FormUpdates",strFormId);this.registerFormHiddenElement("Qform__FormCheckableControls",strFormId)};this.registerFormHiddenElement=function(strId,strFormId){var objHiddenElement=document.createElement("input");objHiddenElement.type="hidden";objHiddenElement.id=strId;objHiddenElement.name=strId;document.getElementById(strFormId).appendChild(objHiddenElement)};this.wrappers=new Array();this.enableMouseDrag=function(){document.onmousedown=qcodo.handleMouseDown;document.onmousemove=qcodo.handleMouseMove;document.onmouseup=qcodo.handleMouseUp};this.handleMouseDown=function(objEvent){objEvent=qcodo.handleEvent(objEvent);var objHandle=qcodo.target;if(!objHandle){return true}var objWrapper=objHandle.wrapper;if(!objWrapper){return true}if(qcodo.mouse.left){if(objWrapper.handleMouseDown){if(objHandle.setCapture){objHandle.setCapture()}objHandle.onmouseout=null;if(document.selection){document.selection.empty()}qcodo.currentMouseHandleControl=objWrapper;return objWrapper.handleMouseDown(objEvent,objHandle)}}qcodo.currentMouseHandleControl=null;return true};this.handleMouseMove=function(objEvent){objEvent=qcodo.handleEvent(objEvent);if(qcodo.currentMouseHandleControl){var objWrapper=qcodo.currentMouseHandleControl;var objHandle=objWrapper.handle;if(document.selection){document.selection.empty()}if(objWrapper.handleMouseMove){return objWrapper.handleMouseMove(objEvent,objHandle)}}return true};this.handleMouseUp=function(objEvent){objEvent=qcodo.handleEvent(objEvent);if(qcodo.currentMouseHandleControl){var objWrapper=qcodo.currentMouseHandleControl;var objHandle=objWrapper.handle;if(document.selection){document.selection.empty()}if(objHandle.releaseCapture){objHandle.releaseCapture();objHandle.onmouseout=function(){this.releaseCapture()}}qcodo.currentMouseHandleControl=null;if(objWrapper.handleMouseUp){return objWrapper.handleMouseUp(objEvent,objHandle)}}return true};this.unloadFlag=false;this.handleUnload=function(){qcodo.unloadFlag=true};window.onunload=this.handleUnload;this.beforeUnloadFlag=false;this.handleBeforeUnload=function(){qcodo.beforeUnloadFlag=true};window.onbeforeunload=this.handleBeforeUnload;this.colorRgbValues=function(strColor){strColor=strColor.replace("#","");try{if(strColor.length==3){return new Array(eval("0x"+strColor.substring(0,1)),eval("0x"+strColor.substring(1,2)),eval("0x"+strColor.substring(2,3)))}else{if(strColor.length==6){return new Array(eval("0x"+strColor.substring(0,2)),eval("0x"+strColor.substring(2,4)),eval("0x"+strColor.substring(4,6)))}}}catch(Exception){}return new Array(0,0,0)};this.hexFromInt=function(intNumber){intNumber=(intNumber>255)?255:((intNumber<0)?0:intNumber);intFirst=Math.floor(intNumber/16);intSecond=intNumber%16;return intFirst.toString(16)+intSecond.toString(16)};this.colorRgbString=function(intRgbArray){return"#"+qcodo.hexFromInt(intRgbArray[0])+qcodo.hexFromInt(intRgbArray[1])+qcodo.hexFromInt(intRgbArray[2])}}};var qc=qcodo;qc.initialize();qcodo.logMessage=function(F,E,D){var A=qcodo.getControl("Qform_Logger");if(!A){var A=document.createElement("div");A.id="Qform_Logger";A.style.display="none";A.style.width="400px";A.style.backgroundColor="#dddddd";A.style.fontSize="10px";A.style.fontFamily="lucida console, courier, monospaced";A.style.padding="6px";A.style.overflow="auto";if(qcodo.isBrowser(qcodo.IE)){A.style.filter="alpha(opacity=50)"}else{A.style.opacity=0.5}document.body.appendChild(A)}if(!D){if(F.replace){F=F.replace(/</g,"&lt;")}}var C="fixed";var B="0px";var H="0px";if(qcodo.isBrowser(qcodo.IE)){C="absolute";B=qcodo.scroll.y+"px";H=qcodo.scroll.x+"px"}A.style.position=C;A.style.top=B;A.style.left=H;A.style.height=(qcodo.client.height-100)+"px";A.style.display="inline";var G='<a href="javascript:qcodo.logRemove()">Remove</a><br/><br/>';if(E){A.innerHTML=G+F+"<br/>"}else{if(A.innerHTML==""){A.innerHTML=G+F+"<br/>"}else{A.innerHTML+=F+"<br/>"}}};qcodo.logRemove=function(){var A=qcodo.getControl("Qform_Logger");if(A){A.style.display="none"}};qcodo.logEventStats=function(A){A=qcodo.handleEvent(A);var B="";B+="scroll (x, y): "+qcodo.scroll.x+", "+qcodo.scroll.y+"<br/>";B+="scroll (width, height): "+qcodo.scroll.width+", "+qcodo.scroll.height+"<br/>";B+="client (x, y): "+qcodo.client.x+", "+qcodo.client.y+"<br/>";B+="client (width, height): "+qcodo.client.width+", "+qcodo.client.height+"<br/>";B+="page (x, y): "+qcodo.page.x+", "+qcodo.page.y+"<br/>";B+="page (width, height): "+qcodo.page.width+", "+qcodo.page.height+"<br/>";B+="mouse (x, y): "+qcodo.mouse.x+", "+qcodo.mouse.y+"<br/>";B+="mouse (left, middle, right): "+qcodo.mouse.left+", "+qcodo.mouse.middle+", "+qcodo.mouse.right+"<br/>";B+="key (alt, shift, control, code): "+qcodo.key.alt+", "+qcodo.key.shift+", "+qcodo.key.control+", "+qcodo.key.code;qcodo.logMessage("Event Stats",true);qcodo.logMessage(B,false,true)};qcodo.logObject=function(A){var D="";for(var C in A){var B=A[C];D+=C+": ";if(typeof B=="function"){D+="&lt;FUNCTION&gt;"}else{if(typeof B=="object"){D+="&lt;OBJECT&gt;"}else{if((C=="outerText")||(C=="innerText")||(C=="outerHTML")||(C=="innerHTML")){D+="&lt;TEXT&gt;"}else{D+=B}}}D+="<br/>"}qcodo.logMessage("Object Stats",true);qcodo.logMessage(D,false,true)};qcodo._objTimers=new Object();qcodo.clearTimeout=function(A){if(qcodo._objTimers[A]){clearTimeout(qcodo._objTimers[A]);qcodo._objTimers[A]=null}};qcodo.setTimeout=function(B,C,A){qcodo.clearTimeout(B);qcodo._objTimers[B]=setTimeout(C,A)};qcodo.handleEvent=function(A){A=(A)?A:((typeof (event)=="object")?event:null);if(A){if(typeof (A.clientX)!="undefined"){if(qcodo.isBrowser(qcodo.SAFARI)){qcodo.mouse.x=A.clientX-window.document.body.scrollLeft;qcodo.mouse.y=A.clientY-window.document.body.scrollTop;qcodo.client.x=A.clientX-window.document.body.scrollLeft;qcodo.client.y=A.clientY-window.document.body.scrollTop}else{qcodo.mouse.x=A.clientX;qcodo.mouse.y=A.clientY;qcodo.client.x=A.clientX;qcodo.client.y=A.clientY}}if(qcodo.isBrowser(qcodo.IE)){qcodo.mouse.left=((A.button&1)?true:false);qcodo.mouse.right=((A.button&2)?true:false);qcodo.mouse.middle=((A.button&4)?true:false)}else{if(qcodo.isBrowser(qcodo.SAFARI)){qcodo.mouse.left=((A.button&&!A.ctrlKey)?true:false);qcodo.mouse.right=((A.button&&A.ctrlKey)?true:false);qcodo.mouse.middle=false}else{qcodo.mouse.left=(A.button==0);qcodo.mouse.right=(A.button==2);qcodo.mouse.middle=(A.button==1)}}qcodo.key.alt=(A.altKey)?true:false;qcodo.key.control=(A.ctrlKey)?true:false;qcodo.key.shift=(A.shiftKey)?true:false;qcodo.key.code=(A.keyCode)?(A.keyCode):0;if(A.originalTarget){qcodo.target=A.originalTarget}else{if(A.srcElement){qcodo.target=A.srcElement}else{qcodo.target=null}}}if(window.document.compatMode=="BackCompat"){qcodo.client.width=(qcodo.isBrowser(qcodo.SAFARI))?window.innerWidth:window.document.body.clientWidth;qcodo.client.height=(qcodo.isBrowser(qcodo.SAFARI))?window.innerHeight:window.document.body.clientHeight;qcodo.page.width=Math.max(window.document.body.scrollWidth,qcodo.client.width);qcodo.page.height=Math.max(window.document.body.scrollHeight,qcodo.client.height);qcodo.scroll.x=window.scrollX||window.document.body.scrollLeft;qcodo.scroll.y=window.scrollY||window.document.body.scrollTop}else{if(qcodo.isBrowser(qcodo.SAFARI)){qcodo.client.width=window.innerWidth;qcodo.client.height=window.innerHeight;qcodo.page.width=Math.max(window.document.body.scrollWidth,qcodo.client.width);qcodo.page.height=Math.max(window.document.body.scrollHeight,qcodo.client.height);qcodo.scroll.x=window.scrollX||window.document.body.scrollLeft;qcodo.scroll.y=window.scrollY||window.document.body.scrollTop}else{if(qcodo.isBrowser(qcodo.IE)){qcodo.client.width=window.document.documentElement.offsetWidth;qcodo.client.height=window.document.documentElement.offsetHeight;qcodo.page.width=Math.max(window.document.documentElement.scrollWidth,qcodo.client.width);qcodo.page.height=Math.max(window.document.documentElement.scrollHeight,qcodo.client.height);qcodo.scroll.x=window.document.documentElement.scrollLeft;qcodo.scroll.y=window.document.documentElement.scrollTop}else{if(window.scrollMaxY){qcodo.client.width=window.innerWidth-15}else{qcodo.client.width=window.innerWidth}if(window.scrollMaxX){qcodo.client.height=window.innerHeight-15}else{qcodo.client.height=window.innerHeight}qcodo.page.width=window.scrollMaxX+qcodo.client.width;qcodo.page.height=window.scrollMaxY+qcodo.client.height;qcodo.scroll.x=window.scrollX;qcodo.scroll.y=window.scrollY}}}qcodo.page.x=qcodo.mouse.x+qcodo.scroll.x;qcodo.page.y=qcodo.mouse.y+qcodo.scroll.y;qcodo.scroll.width=qcodo.page.width-qcodo.client.width;qcodo.scroll.height=qcodo.page.height-qcodo.client.height;return A};qcodo.terminateEvent=function(A){A=qcodo.handleEvent(A);if(A){if(A.preventDefault){A.preventDefault()}if(A.stopPropagation){A.stopPropagation()}A.cancelBubble=true;A.returnValue=false}return false};qcodo.key={control:false,alt:false,shift:false,code:null};qcodo.mouse={x:0,y:0,left:false,middle:false,right:false};qcodo.client={x:null,y:null,width:null,height:null};qcodo.page={x:null,y:null,width:null,height:null};qcodo.scroll={x:window.scrollX||(window.document.body)?window.document.body.scrollLeft:null,y:window.scrollY||(window.document.body)?window.document.body.scrollTop:null,width:(window.document.body)?(window.document.body.scrollWidth-qcodo.client.width):null,height:(window.document.body)?(window.document.body.scrollHeight-qcodo.client.height):null};qcodo.postBack=function(C,E,B,A){var D=document.getElementById(C);D.Qform__FormControl.value=E;D.Qform__FormEvent.value=B;D.Qform__FormParameter.value=A;D.Qform__FormCallType.value="Server";D.Qform__FormUpdates.value=this.formUpdates();D.Qform__FormCheckableControls.value=this.formCheckableControls(C,"Server");D.submit()};qcodo.formUpdates=function(){var B="";for(var C in qcodo.controlModifications){for(var A in qcodo.controlModifications[C]){B+=C+" "+A+" "+qcodo.controlModifications[C][A]+"\n"}}qcodo.controlModifications=new Array();return B};qcodo.formCheckableControls=function(D,C){var E=document.getElementById(D);var B="";for(var A=0;A<E.elements.length;A++){if(((E.elements[A].type=="checkbox")||(E.elements[A].type=="radio"))&&((C=="Ajax")||(!E.elements[A].disabled))){if(E.elements[A].id.indexOf("[")>=0){if(E.elements[A].id.indexOf("[0]")>=0){B+=" "+E.elements[A].id.substring(0,E.elements[A].id.length-3)}}else{if(E.elements[A].id.indexOf("_")>=0){if(E.elements[A].id.indexOf("_0")>=0){B+=" "+E.elements[A].id.substring(0,E.elements[A].id.length-2)}}else{B+=" "+E.elements[A].id}}}}if(B.length>0){return B.substring(1)}else{return""}};qcodo.ajaxQueue=new Array();qcodo.postAjax=function(E,F,D,C,B){if(!qc.unloadFlag){if(qc.beforeUnloadFlag){qc.beforeUnloadFlag=false}var A=false;if(qcodo.ajaxQueue.length==0){A=true}qcodo.ajaxQueue.push(new Array(E,F,D,C,B));if(A){qcodo.dequeueAjaxQueue()}}};qcodo.clearAjaxQueue=function(){qcodo.ajaxQueue=new Array()};qcodo.objAjaxWaitIcon=null;qcodo.dequeueAjaxQueue=function(){if(qcodo.ajaxQueue.length>0){strForm=this.ajaxQueue[0][0];strControl=this.ajaxQueue[0][1];strEvent=this.ajaxQueue[0][2];strParameter=this.ajaxQueue[0][3];strWaitIconControlId=this.ajaxQueue[0][4];if(strWaitIconControlId){this.objAjaxWaitIcon=this.getWrapper(strWaitIconControlId);if(this.objAjaxWaitIcon){this.objAjaxWaitIcon.style.display="inline"}}var objForm=document.getElementById(strForm);objForm.Qform__FormControl.value=strControl;objForm.Qform__FormEvent.value=strEvent;objForm.Qform__FormParameter.value=strParameter;objForm.Qform__FormCallType.value="Ajax";objForm.Qform__FormUpdates.value=qcodo.formUpdates();objForm.Qform__FormCheckableControls.value=this.formCheckableControls(strForm,"Ajax");var strPostData="";for(var i=0;i<objForm.elements.length;i++){switch(objForm.elements[i].type){case"checkbox":case"radio":if(objForm.elements[i].checked){var strTestName=objForm.elements[i].name+"_";if(objForm.elements[i].id.substring(0,strTestName.length)==strTestName){strPostData+="&"+objForm.elements[i].name+"="+objForm.elements[i].id.substring(strTestName.length)}else{strPostData+="&"+objForm.elements[i].id+"="+objForm.elements[i].value}}break;case"select-multiple":var blnOneSelected=false;for(var intIndex=0;intIndex<objForm.elements[i].options.length;intIndex++){if(objForm.elements[i].options[intIndex].selected){strPostData+="&"+objForm.elements[i].name+"=";strPostData+=objForm.elements[i].options[intIndex].value}}break;default:strPostData+="&"+objForm.elements[i].id+"=";var strPostValue=objForm.elements[i].value;if(strPostValue){strPostValue=strPostValue.replace(/\%/g,"%25");strPostValue=strPostValue.replace(/&/g,escape("&"));strPostValue=strPostValue.replace(/\+/g,"%2B")}strPostData+=strPostValue;break}}var strUri=objForm.action;var objRequest;if(window.XMLHttpRequest){objRequest=new XMLHttpRequest()}else{if(typeof ActiveXObject!="undefined"){objRequest=new ActiveXObject("Microsoft.XMLHTTP")}}if(objRequest){objRequest.open("POST",strUri,true);objRequest.setRequestHeader("Method","POST "+strUri+" HTTP/1.1");objRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");objRequest.onreadystatechange=function(){if(objRequest.readyState==4){if(!qcodo.beforeUnloadFlag){try{var objXmlDoc=objRequest.responseXML;if(!objXmlDoc){alert("An error occurred during AJAX Response parsing.\r\n\r\nThe error response will appear in a new popup.");var objErrorWindow=window.open("about:blank","qcodo_error","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=1000,height=700,left=50,top=50");objErrorWindow.focus();objErrorWindow.document.write(objRequest.responseText);return }else{var intLength=0;var objXmlControls=objXmlDoc.getElementsByTagName("control");intLength=objXmlControls.length;for(var intIndex=0;intIndex<intLength;intIndex++){var strControlId=objXmlControls[intIndex].attributes.getNamedItem("id").nodeValue;var strControlHtml="";if(objXmlControls[intIndex].textContent){strControlHtml=objXmlControls[intIndex].textContent}else{if(objXmlControls[intIndex].firstChild){strControlHtml=objXmlControls[intIndex].firstChild.nodeValue}}if(strControlId=="Qform__FormState"){var objFormState=document.getElementById(strControlId);objFormState.value=strControlHtml}else{var objSpan=document.getElementById(strControlId+"_ctl");if(objSpan){objSpan.innerHTML=strControlHtml}}}var objXmlCommands=objXmlDoc.getElementsByTagName("command");intLength=objXmlCommands.length;for(var intIndex=0;intIndex<intLength;intIndex++){if(objXmlCommands[intIndex]&&objXmlCommands[intIndex].firstChild){var strCommand="";intChildLength=objXmlCommands[intIndex].childNodes.length;for(var intChildIndex=0;intChildIndex<intChildLength;intChildIndex++){strCommand+=objXmlCommands[intIndex].childNodes[intChildIndex].nodeValue}eval(strCommand)}}}}catch(objExc){alert(objExc.message+"\r\non line number "+objExc.lineNumber+"\r\nin file "+objExc.fileName);alert("An error occurred during AJAX Response handling.\r\n\r\nThe error response will appear in a new popup.");var objErrorWindow=window.open("about:blank","qcodo_error","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=1000,height=700,left=50,top=50");objErrorWindow.focus();objErrorWindow.document.write(objRequest.responseText);return }}qcodo.ajaxQueue.shift();if(qcodo.objAjaxWaitIcon){qcodo.objAjaxWaitIcon.style.display="none"}if(qcodo.ajaxQueue.length>0){qcodo.dequeueAjaxQueue()}}};objRequest.send(strPostData)}}};qc.pB=qcodo.postBack;qc.pA=qcodo.postAjax;qcodo.getControl=function(A){if(typeof (A)=="string"){return document.getElementById(A)}else{return A}};qcodo.getWrapper=function(B){var A;if(!(A=qcodo.getControl(B))){return }if(A){return this.getControl(A.id+"_ctl")}else{return null}};qcodo.controlModifications=new Array();qcodo.javascriptStyleToQcodo=new Array();qcodo.javascriptStyleToQcodo.backgroundColor="BackColor";qcodo.javascriptStyleToQcodo.borderColor="BorderColor";qcodo.javascriptStyleToQcodo.borderStyle="BorderStyle";qcodo.javascriptStyleToQcodo.border="BorderWidth";qcodo.javascriptStyleToQcodo.height="Height";qcodo.javascriptStyleToQcodo.width="Width";qcodo.javascriptStyleToQcodo.text="Text";qcodo.javascriptWrapperStyleToQcodo=new Array();qcodo.javascriptWrapperStyleToQcodo.position="Position";qcodo.javascriptWrapperStyleToQcodo.top="Top";qcodo.javascriptWrapperStyleToQcodo.left="Left";qcodo.recordControlModification=function(C,A,B){if(!qcodo.controlModifications[C]){qcodo.controlModifications[C]=new Array()}qcodo.controlModifications[C][A]=B};qcodo.registerControl=function(B){var A;if(!(A=qcodo.getControl(B))){return }var C=this.getWrapper(A);A.wrapper=C;C.control=A;qcodo.wrappers[C.id]=C;C.updateStyle=function(F,E){var D=this.control;switch(F){case"className":D.className=E;qcodo.recordControlModification(D.id,"CssClass",E);break;case"parent":if(E){var G=qcodo.getControl(E);G.appendChild(this);qcodo.recordControlModification(D.id,"Parent",E)}else{var H=this.parentNode;H.removeChild(this);qcodo.recordControlModification(D.id,"Parent","")}break;case"displayStyle":D.style.display=E;qcodo.recordControlModification(D.id,"DisplayStyle",E);break;case"display":if(E){C.style.display="inline";qcodo.recordControlModification(D.id,"Display","1")}else{C.style.display="none";qcodo.recordControlModification(D.id,"Display","0")}break;case"enabled":if(E){C.control.disabled=false;qcodo.recordControlModification(D.id,"Enabled","1")}else{C.control.disabled=true;qcodo.recordControlModification(D.id,"Enabled","0")}break;case"width":case"height":D.style[F]=E;if(qcodo.javascriptStyleToQcodo[F]){qcodo.recordControlModification(D.id,qcodo.javascriptStyleToQcodo[F],E)}if(C.handle){C.updateHandle()}break;case"text":D.innerHTML=E;qcodo.recordControlModification(D.id,"Text",E);break;default:if(qcodo.javascriptWrapperStyleToQcodo[F]){this.style[F]=E;qcodo.recordControlModification(D.id,qcodo.javascriptWrapperStyleToQcodo[F],E)}else{D.style[F]=E;if(qcodo.javascriptStyleToQcodo[F]){qcodo.recordControlModification(D.id,qcodo.javascriptStyleToQcodo[F],E)}}break}};C.getAbsolutePosition=function(){var F=0;var E=0;var D=this.control;while(D){if((D.wrapper)&&(D.wrapper.style.position=="relative")){}else{F+=D.offsetLeft;E+=D.offsetTop}D=D.offsetParent}return{x:F,y:E}};C.setAbsolutePosition=function(G,F,E){var D=this.offsetParent;while(D){G-=D.offsetLeft;F-=D.offsetTop;D=D.offsetParent}if(E){if(this.parentNode.nodeName.toLowerCase()!="form"){G=Math.max(G,0);F=Math.max(F,0);G=Math.min(G,this.offsetParent.offsetWidth-this.offsetWidth);F=Math.min(F,this.offsetParent.offsetHeight-this.offsetHeight)}}this.updateStyle("left",G+"px");this.updateStyle("top",F+"px")};C.setDropZoneMaskAbsolutePosition=function(F,E,D){this.dropZoneMask.style.left=F+"px";this.dropZoneMask.style.top=E+"px"};C.setMaskOffset=function(E,D){var F=this.getAbsolutePosition();this.mask.style.left=(F.x+E)+"px";this.mask.style.top=(F.y+D)+"px"};C.containsPoint=function(E,D){var F=this.getAbsolutePosition();if((E>=F.x)&&(E<=F.x+this.control.offsetWidth)&&(D>=F.y)&&(D<=F.y+this.control.offsetHeight)){return true}else{return false}};C.toggleDisplay=function(D){if(D){if(D=="show"){this.updateStyle("display",true)}else{this.updateStyle("display",false)}}else{this.updateStyle("display",(this.style.display=="none")?true:false)}};C.toggleEnabled=function(D){if(D){if(D=="enable"){this.updateStyle("enabled",true)}else{this.updateStyle("enabled",false)}}else{this.updateStyle("enabled",(this.control.disabled)?true:false)}};C.registerClickPosition=function(D){D=(D)?D:((typeof (event)=="object")?event:null);qcodo.handleEvent(D);var F=qcodo.mouse.x-this.getAbsolutePosition().x+qcodo.scroll.x;var E=qcodo.mouse.y-this.getAbsolutePosition().y+qcodo.scroll.y;if(qcodo.isBrowser(qcodo.IE)){F=F-2;E=E-2}document.getElementById(this.control.id+"_x").value=F;document.getElementById(this.control.id+"_y").value=E};C.focus=function(){if(this.control.focus){if(qcodo.isBrowser(qcodo.IE)&&(typeof (this.control.focus)=="object")){this.control.focus()}else{if(typeof (this.control.focus)=="function"){this.control.focus()}}}};C.select=function(){if(this.control.select){this.control.select()}};C.blink=function(E,D){C.defaultBackgroundColor=C.control.style.backgroundColor;C.blinkStart=qcodo.colorRgbValues(E);C.blinkEnd=qcodo.colorRgbValues(D);C.blinkStep=new Array(Math.round((C.blinkEnd[0]-C.blinkStart[0])/12.5),Math.round((C.blinkEnd[1]-C.blinkStart[1])/12.5),Math.round((C.blinkEnd[2]-C.blinkStart[2])/12.5));C.blinkDown=new Array((C.blinkStep[0]<0)?true:false,(C.blinkStep[1]<0)?true:false,(C.blinkStep[2]<0)?true:false);C.blinkCurrent=C.blinkStart;this.control.style.backgroundColor=qcodo.colorRgbString(C.blinkCurrent);qcodo.setTimeout(C.id,"qc.getC('"+C.id+"').blinkHelper()",20)};C.blinkHelper=function(){C.blinkCurrent[0]+=C.blinkStep[0];C.blinkCurrent[1]+=C.blinkStep[1];C.blinkCurrent[2]+=C.blinkStep[2];if(((C.blinkDown[0])&&(C.blinkCurrent[0]<C.blinkEnd[0]))||((!C.blinkDown[0])&&(C.blinkCurrent[0]>C.blinkEnd[0]))){C.blinkCurrent[0]=C.blinkEnd[0]}if(((C.blinkDown[1])&&(C.blinkCurrent[1]<C.blinkEnd[1]))||((!C.blinkDown[1])&&(C.blinkCurrent[1]>C.blinkEnd[1]))){C.blinkCurrent[1]=C.blinkEnd[1]}if(((C.blinkDown[2])&&(C.blinkCurrent[2]<C.blinkEnd[2]))||((!C.blinkDown[2])&&(C.blinkCurrent[2]>C.blinkEnd[2]))){C.blinkCurrent[2]=C.blinkEnd[2]}this.control.style.backgroundColor=qcodo.colorRgbString(C.blinkCurrent);if((C.blinkCurrent[0]==C.blinkEnd[0])&&(C.blinkCurrent[1]==C.blinkEnd[1])&&(C.blinkCurrent[2]==C.blinkEnd[2])){this.control.style.backgroundColor=C.defaultBackgroundColor}else{qcodo.setTimeout(C.id,"qc.getC('"+C.id+"').blinkHelper()",20)}}};qcodo.registerControlArray=function(B){var C=B.length;for(var A=0;A<C;A++){qcodo.registerControl(B[A])}};qc.getC=qcodo.getControl;qc.getW=qcodo.getWrapper;qc.regC=qcodo.registerControl;qc.regCA=qcodo.registerControlArray;function __resetListBox(C,B){var A=document.forms[C].elements[B];A.selectedIndex=-1;if(A.onchange){A.onchange()}}qcodo.registerControlHandle=function(B,E){var A;if(!(A=qcodo.getControl(B))){return }var C=A.wrapper;if(!C.handle){var D=document.createElement("span");D.id=C.id+"handle";C.parentNode.appendChild(D);C.handle=D;D.wrapper=C;if(!C.style.position){D.style.width=C.control.style.width;D.style.height=C.control.style.height;D.style.top=C.control.offsetTop+"px";D.style.left=C.control.offsetLeft+"px"}else{D.style.width=C.offsetWidth+"px";D.style.height=C.offsetHeight+"px";D.style.top=C.offsetTop+"px";D.style.left=C.offsetLeft+"px"}D.style.cursor=E;D.style.zIndex=999;D.style.backgroundColor="white";if(qcodo.isBrowser(qcodo.IE)){D.style.filter="alpha(opacity=0)"}else{D.style.opacity=0}D.style.position="absolute";D.style.fontSize="1px";D.innerHTML="."}C.updateHandle=function(H,G){var F=this.handle;if(H){this.parentNode.appendChild(F)}F.style.top=this.offsetTop+"px";F.style.left=this.offsetLeft+"px";F.style.width=this.offsetWidth+"px";F.style.height=this.offsetHeight+"px";if(G){F.style.cursor=G}}};qc.regCH=qcodo.registerControlHandle;qcodo.registerControlResizeHandle=function(mixControl,blnVertical){var objControl;if(!(objControl=qcodo.getControl(mixControl))){return }var objWrapper=objControl.wrapper;objWrapper.resizeHandle=true;objWrapper.resizeDirectionVertical=blnVertical;objWrapper.resizeUpperControls=new Array();objWrapper.resizeLowerControls=new Array();if(!objWrapper.handle){if(qcodo.isBrowser(qcodo.SAFARI)){qcodo.registerControlHandle(objControl,"move")}else{if(qcodo.isBrowser(qcodo.IE)){if(objWrapper.resizeDirectionVertical){qcodo.registerControlHandle(objControl,"row-resize")}else{qcodo.registerControlHandle(objControl,"col-resize")}}else{if(objWrapper.resizeDirectionVertical){qcodo.registerControlHandle(objControl,"ns-resize")}else{qcodo.registerControlHandle(objControl,"ew-resize")}}}qcodo.enableMouseDrag();objWrapper.handleMouseDown=function(objEvent,objHandle){this.startUpperSizes=new Array();this.startLowerSizes=new Array();this.startLowerPositions=new Array();if(this.resizeDirectionVertical){this.offsetY=qcodo.page.y-this.getAbsolutePosition().y;this.startDragY=qcodo.page.y;for(var intIndex=0;intIndex<this.resizeUpperControls.length;intIndex++){var objUpperControl=this.resizeUpperControls[intIndex];this.startUpperSizes[intIndex]=eval(objUpperControl.control.style.height.replace(/px/,""))}for(var intIndex=0;intIndex<this.resizeLowerControls.length;intIndex++){var objLowerControl=this.resizeLowerControls[intIndex];this.startLowerPositions[intIndex]=objLowerControl.getAbsolutePosition().y;this.startLowerSizes[intIndex]=eval(objLowerControl.control.style.height.replace(/px/,""))}if(this.resizeMinimum!=null){this.resizeMinimumY=this.getAbsolutePosition().y-(this.offsetTop-this.resizeMinimum)}else{this.resizeMinimumY=null}if(this.resizeMaximum!=null){this.resizeMaximumY=this.getAbsolutePosition().y-(this.offsetTop-this.resizeMaximum)}else{this.resizeMaximumY=null}}else{this.offsetX=qcodo.page.x-this.getAbsolutePosition().x;this.startDragX=qcodo.page.x;for(var intIndex=0;intIndex<this.resizeUpperControls.length;intIndex++){var objUpperControl=this.resizeUpperControls[intIndex];this.startUpperSizes[intIndex]=eval(objUpperControl.control.style.width.replace(/px/,""))}for(var intIndex=0;intIndex<this.resizeLowerControls.length;intIndex++){var objLowerControl=this.resizeLowerControls[intIndex];this.startLowerPositions[intIndex]=objLowerControl.getAbsolutePosition().x;this.startLowerSizes[intIndex]=eval(objLowerControl.control.style.width.replace(/px/,""))}if(this.resizeMinimum!=null){this.resizeMinimumX=this.getAbsolutePosition().x-(this.offsetLeft-this.resizeMinimum)}else{this.resizeMinimumX=null}if(this.resizeMaximum!=null){this.resizeMaximumX=this.getAbsolutePosition().x-(this.offsetLeft-this.resizeMaximum)}else{this.resizeMaximumX=null}}return qcodo.terminateEvent(objEvent)};objWrapper.handleMouseMove=function(objEvent,objHandle){if(this.resizeDirectionVertical){var intNewY=qcodo.page.y-this.offsetY;if(this.resizeMinimumY!=null){intNewY=Math.max(intNewY,this.resizeMinimumY)}if(this.resizeMaximumY!=null){intNewY=Math.min(intNewY,this.resizeMaximumY)}var intDeltaY=intNewY-this.startDragY+this.offsetY;this.setAbsolutePosition(this.getAbsolutePosition().x,intNewY);for(var intIndex=0;intIndex<this.resizeUpperControls.length;intIndex++){var objUpperControl=this.resizeUpperControls[intIndex];objUpperControl.updateStyle("height",this.startUpperSizes[intIndex]+intDeltaY+"px")}for(var intIndex=0;intIndex<this.resizeLowerControls.length;intIndex++){var objLowerControl=this.resizeLowerControls[intIndex];objLowerControl.setAbsolutePosition(objLowerControl.getAbsolutePosition().x,this.startLowerPositions[intIndex]+intDeltaY);objLowerControl.updateStyle("height",this.startLowerSizes[intIndex]-intDeltaY+"px")}}else{var intNewX=qcodo.page.x-this.offsetX;if(this.resizeMinimumX!=null){intNewX=Math.max(intNewX,this.resizeMinimumX)}if(this.resizeMaximumX!=null){intNewX=Math.min(intNewX,this.resizeMaximumX)}var intDeltaX=intNewX-this.startDragX+this.offsetX;this.setAbsolutePosition(intNewX,this.getAbsolutePosition().y);for(var intIndex=0;intIndex<this.resizeUpperControls.length;intIndex++){var objUpperControl=this.resizeUpperControls[intIndex];objUpperControl.updateStyle("width",this.startUpperSizes[intIndex]+intDeltaX+"px")}for(var intIndex=0;intIndex<this.resizeLowerControls.length;intIndex++){var objLowerControl=this.resizeLowerControls[intIndex];objLowerControl.setAbsolutePosition(this.startLowerPositions[intIndex]+intDeltaX,objLowerControl.getAbsolutePosition().y);objLowerControl.updateStyle("width",this.startLowerSizes[intIndex]-intDeltaX+"px")}}this.updateHandle(false);return qcodo.terminateEvent(objEvent)};objWrapper.handleMouseUp=function(objEvent,objHandle){var blnResized=true;if(this.resizeDirectionVertical){if(this.startDragY==qcodo.page.y){blnResized=false}}else{if(this.startDragX==qcodo.page.x){blnResized=false}}if(blnResized){this.updateHandle(true);if(this.control.getAttribute("onqcodoresize")){this.control.qcodoresize=function(strOnResizeCommand){eval(strOnResizeCommand)};this.control.qcodoresize(this.control.getAttribute("onqcodoresize"))}return qcodo.terminateEvent(objEvent)}else{if(this.control.onclick){return this.control.onclick(objEvent)}else{return true}}};objWrapper.setUpperControl=function(mixControl){var objControl;if(!(objControl=qcodo.getControl(mixControl))){return }var objWrapper=objControl.wrapper;this.resizeUpperControls[this.resizeUpperControls.length]=objWrapper};objWrapper.setLowerControl=function(mixControl){var objControl;if(!(objControl=qcodo.getControl(mixControl))){return }var objWrapper=objControl.wrapper;this.resizeLowerControls[this.resizeLowerControls.length]=objWrapper};objWrapper.resizeMinimum=null;objWrapper.resizeMaximum=null;objWrapper.setResizeMinimum=function(intMinimum){this.resizeMinimum=intMinimum};objWrapper.setResizeMaximum=function(intMaximum){this.resizeMaximum=intMaximum};objWrapper.setUC=objWrapper.setUpperControl;objWrapper.setLC=objWrapper.setLowerControl;objWrapper.setReMi=objWrapper.setResizeMinimum;objWrapper.setReMa=objWrapper.setResizeMaximum}else{objWrapper.updateHandle()}};qc.regCRH=qcodo.registerControlResizeHandle;qcodo.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");qcodo.monthNamesAbbreviated=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");qcodo.dayNames=new Array("Su","Mo","Tu","We","Th","Fr","Sa");qcodo.registerCalendar=function(B,D){qcodo.handleEvent();var A;if(!(A=qcodo.getControl(B))){return }var C=A.wrapper;A.dateTimeTextBox=qcodo.getControl(D);A.calendarPane=document.getElementById(A.id+"_cal");A.calendarPane.style.display="none";A.showCalendar=function(){var E=this.wrapper.getAbsolutePosition();this.calendarPane.style.left=E.x+"px";this.calendarPane.style.top=E.y+"px";this.calendarPane.style.position="absolute";this.calendarPane.style.zIndex=10;this.calendarPane.style.display="block";this.drawCalendar(0,0)};A.setDate=function(E,F,G){this.dateTimeTextBox.value=qcodo.monthNamesAbbreviated[F]+" "+G+" "+E;this.hideCalendar()};A.setToToday=function(){var E=new Date();this.setDate(E.getFullYear(),E.getMonth(),E.getDate())};A.drawCalendar=function(M,T){var H;if(this.dateTimeTextBox.value){H=new Date(this.dateTimeTextBox.value)}var J=new Date();var G;if(M){G=new Date(M,T,1)}else{if(!H||H=="Invalid Date"){G=new Date()}else{G=new Date(H)}}G.setDate(1);var Q=G.getMonth();var F=G.getFullYear();var K='<table border="0" cellspacing="0"><thead><tr>';for(var E in qcodo.dayNames){K+="<th>"+qcodo.dayNames[E]+"</th>"}K+="</tr></thead>";for(var Y=G.getDay();Y>0;Y--){G.setDate(G.getDate()-1)}for(var S=0;S<6;S++){K+="<tr>";for(var E=0;E<7;E++){var Z=(S==5)?"lastRow ":"";if((G.getDate()==J.getDate())&&(G.getMonth()==J.getMonth())&&(G.getFullYear()==J.getFullYear())){Z+="today "}if(H&&(G.getDate()==H.getDate())&&(G.getMonth()==H.getMonth())&&(G.getFullYear()==H.getFullYear())){Z+="selected "}if(G.getMonth()!=Q){Z+="nonMonth"}if(Z){Z=' class="'+Z+'"'}K+="<td"+Z+'><a href="#" onclick="qc.getC(\''+this.id+"').setDate("+G.getFullYear()+","+G.getMonth()+","+G.getDate()+');return false;">'+G.getDate()+"</a></td>";G.setDate(G.getDate()+1)}K+="</tr>"}K+="</table>";var O=Q-1;var R=F;if(O==-1){O=11;R--}var X=R+","+O;var W=Q+1;var N=F;if(W==12){W=0;N++}var P=N+","+W;var U=(F-1)+","+Q;var I=(F+1)+","+Q;var V='<div class="navigator">';V+='<div class="left"><a href="#" onclick="qc.getC(\''+this.id+"').drawCalendar("+X+');return false;">&laquo;</a></div>';V+='<div class="month">'+qcodo.monthNames[Q]+"</div>";V+='<div class="left"><a href="#" onclick="qc.getC(\''+this.id+"').drawCalendar("+P+');return false;">&raquo;</a></div>';V+='<div class="year"><a href="#" onclick="qc.getC(\''+this.id+"').drawCalendar("+U+');return false;">&laquo;</a>';V+="<span>"+F+"</span>";V+='<a href="#" onclick="qc.getC(\''+this.id+"').drawCalendar("+I+');return false;">&raquo;</a></div>';V+="</div>";var L='<div class="options">';L+='<a href="#" onclick="qc.getC(\''+this.id+"').setToToday(); return false;\">&quot;Today&quot;</a> &nbsp; &nbsp; ";L+='<a href="#" onclick="qc.getC(\''+this.id+"').hideCalendar(); return false;\">Cancel</a></div>";this.calendarPane.innerHTML=V+K+L};A.hideCalendar=function(){this.calendarPane.style.display="none"};A.onclick=A.showCalendar};qc.regCAL=qcodo.registerCalendar;function __calendar(B,A){popCal=window.open(qc.phpAssets+"/_core/calendar.php?strFormId="+B+"&strId="+A+"&intTimestamp="+document.forms[B].elements[A+"_intTimestamp"].value,"popCal","width=165,height=228,left=200,top=250");if(window.focus){popCal.focus()}}function __resetCalendar(B,A){document.forms[B].elements[A+"_intTimestamp"].value="";document.forms[B].elements[A].value="";if(document.forms[B].elements[A].onchange){document.forms[B].elements[A].onchange()}}function Qcodo__DateTimePicker_Change(E,H){var D=document.getElementById(E+"_lstMonth");var F=document.getElementById(E+"_lstDay");var B=document.getElementById(E+"_lstYear");if(H.options[H.selectedIndex].value==""){D.selectedIndex=0;B.selectedIndex=0;while(F.options.length){F.options[F.options.length-1]=null}F.options[0]=new Option("--","");F.selectedIndex=0}else{if((H==D)||((H==B)&&(D.options[D.selectedIndex].value==2))){var K=F.options[F.selectedIndex].value;var L=F.options[F.options.length-1].value;var G=0;var C=D.options[D.selectedIndex].value;var J=new Number(B.options[B.selectedIndex].value);if(!J){J=2000}switch(C){case"1":case"3":case"5":case"7":case"8":case"10":case"12":G=31;break;case"4":case"6":case"9":case"11":G=30;break;case"2":if((J%4)!=0){G=28}else{if((J%1000)==0){G=29}else{if((J%100)==0){G=28}else{G=29}}}break}if(G!=L){var I=true;if(F.options[0].value==""){I=false}while(F.options.length){F.options[F.options.length-1]=null}if(!I){F.options[0]=new Option("--","")}for(var A=1;A<=G;A++){F.options[F.options.length]=new Option(A,A)}K=Math.min(K,G);if(I){F.options[K-1].selected=true}else{F.options[K].selected=true}}}}}function treenavToggleImage(D){var C=treenavToggleDisplay(D+"_sub",null,"block");var B=document.getElementById(D+"_image");var E=qc.imageAssets+"/treenav_expanded.png";var A=qc.imageAssets+"/treenav_not_expanded.png";if(C){B.src=E}else{B.src=A}strActualControlId=D.substr(0,D.indexOf("_"));qcodo.recordControlModification(strActualControlId,"ItemExpanded",D+((C)?" 1":" 0"))}function treenavToggleDisplay(C,B,D){var A;if(!(A=qcodo.getControl(C))){return }if(B){if(B=="show"){A.style.display=D;return true}else{A.style.display="none";return false}}else{if(A.style.display=="none"){A.style.display=D;return true}else{A.style.display="none";return false}}}function treenavItemUnselect(C,B){var A=document.getElementById(C);A.className=B;A.onmouseout=function(){treenavItemSetStyle(C,B)}}function treenavItemSetStyle(C,B){var A=document.getElementById(C);A.className=B}function treenavRedrawElement(B,A){document.getElementById(B).innerHTML=A};